{% extends "base.html" %}
{% block content %}


<div sytle="width: 100%; height: 95vh;" id="map"></div>

<script>
 var map = L.map("map").setView([53.2734, -7.77832031], 7);

var osm = L.tileLayer(
  "https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",
  {
	attribution:
	  "&copy; <a href='https://openstreetmap.org/copyright'> Openstreet map</a> contributors",
  }
);

var darkLayer = L.tileLayer(
  "https://tiles.stadiamaps.com/tiles/alidade_smooth_dark/{z}/{x}/{y}{r}.png",
  {
	maxZoom: 20,
	attribution:
	  '&copy; <a href="https://stadiamaps.com/">Stadia Maps</a>, &copy; <a href="https://openmaptiles.org/">OpenMapTiles</a> &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors',
  }
);

var watercolor = L.tileLayer(
  "https://stamen-tiles-{s}.a.ssl.fastly.net/watercolor/{z}/{x}/{y}.{ext}",
  {
	attribution:
	  'Map tiles by <a href="http://stamen.com">Stamen Design</a>, <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a> &mdash; Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
	subdomains: "abcd",
	minZoom: 1,
	maxZoom: 16,
	ext: "jpg",
  }
);

var baseLayers = {
  osm: osm,
  "dark map": darkLayer,
  "water color map": watercolor,
};

osm.addTo(map);

L.control.layers(baseLayers).addTo(map);

function geojsonStyle(feature){
	return {
		fillColor: getColor(feature.properties.p14_100k),
		weight: 2,
		opacity: 0.1, 
		color: 'white',
		fillOpacity: 0.7
	}
}

function getColor(cases) {
	if (cases >  200) {
		return 'DarkRed'
	} else if (cases > 100) {
		return 'red'
	} else if (cases > 50) {
		return 'orange'
	} else if (cases > 25){
		return 'yellow'
	} else if (cases > 10) {
        return 'PapayaWhip'
    } else  if (cases > 0){
        return 'blue'
    } else {
        return 'white'
    }
}

$.getJSON("{% url 'local_area' %}", function(data) {
	console.log(data);
	L.geoJSON(data, {
			style: geojsonStyle,
	}).addTo(map)
})
// let coords = "0.0,0.0";
// let curMarker = null;

// function onMapClick(e) {

// 		if (curMarker != null) {
// 			map.removeLayer(curMarker)
// 		}
//         coords = e.latlng;
//         console.log(coords)
//         let lat, lng = [coords.lat ,coords.lng];
//         console.log(coords.lat)
//         console.log(coords.lng)
//         let test = coords.lat + ',' + coords.lng;
//         console.log(test)
// 		curMarker = L.marker([coords.lat, coords.lng]).addTo(map)
//         coords=test
// }

// map.on('click', onMapClick);

</script>
   
{% endblock %}